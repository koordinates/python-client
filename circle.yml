machine:
  python:
    version: 2.7.11

dependencies:
  pre:
    - pyenv install -s 3.4.4
    - pyenv install -s 3.5.1
    - pyenv global 2.7.11 3.4.4 3.5.1

  post:
    - make docs
    - mv docs/build ${CIRCLE_ARTIFACTS}/docs
    - cd ${CIRCLE_ARTIFACTS}; zip -r docs.zip docs

test:
  pre:
    - mkdir -p ${CIRCLE_TEST_REPORTS}/junit ${CIRCLE_ARTIFACTS}/coverage
  override:
    - tox --
      --verbose
      --with-xunit
      --cover-package=koordinates
      --cover-html
      --cover-html-dir=${CIRCLE_ARTIFACTS}/coverage/
  post:
    - cp nosetests.*.xml ${CIRCLE_TEST_REPORTS}/junit/